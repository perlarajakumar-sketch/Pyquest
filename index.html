<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"/>
<meta name="theme-color" content="#0a0a0f"/>
<meta name="mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<title>PyQuest üêç</title>
<link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Syne:wght@700;800;900&display=swap" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/skulpt@1.2.0/dist/skulpt.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/skulpt@1.2.0/dist/skulpt-stdlib.js"></script>
<style>
:root{
  --bg:#07070e;--bg2:#0d0d1a;--bg3:#12122a;--border:#1e1e40;
  --green:#00ff88;--cyan:#00d4ff;--red:#ff3860;--orange:#ff9f43;
  --yellow:#ffd700;--purple:#a78bfa;--text:#e2e8f0;--muted:#4a5568;
  --mono:'Space Mono',monospace;--display:'Syne',sans-serif;
}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
html,body{background:var(--bg);color:var(--text);font-family:var(--mono);min-height:100vh;overflow-x:hidden;max-width:480px;margin:0 auto;}
/* - SCREENS - */
.screen{display:none;min-height:100vh;}
.screen.active{display:flex;flex-direction:column;}
/* - HOME SCREEN - */
.home-header{background:linear-gradient(160deg,#0d0d1a,#0a071f);padding:28px 20px 20px;border-bottom:1px solid var(--border);}
.home-logo{font-family:var(--display);font-size:32px;font-weight:900;color:var(--green);letter-spacing:2px;text-shadow:0 0 40px #00ff8855;}
.home-tagline{font-size:9px;color:var(--muted);letter-spacing:3px;margin-top:2px;}
.stat-strip{display:flex;gap:10px;margin-top:18px;}
.stat-chip{flex:1;background:var(--bg3);border:1px solid var(--border);border-radius:12px;padding:10px 8px;text-align:center;}
.stat-big{font-family:var(--display);font-size:20px;font-weight:900;color:var(--cyan);}
.stat-lbl{font-size:8px;color:var(--muted);letter-spacing:1.5px;margin-top:2px;}
.xp-bar-wrap{background:var(--border);border-radius:99px;height:7px;overflow:hidden;margin-top:14px;}
.xp-bar-fill{height:100%;background:linear-gradient(90deg,var(--green),var(--cyan));border-radius:99px;transition:width .5s;}
.xp-meta{display:flex;justify-content:space-between;font-size:9px;color:var(--muted);margin-top:4px;}
/* Units */
.units-scroll{flex:1;overflow-y:auto;padding:16px 16px 100px;}
.unit-block{margin-bottom:24px;}
.unit-title{font-family:var(--display);font-size:11px;letter-spacing:3px;color:var(--muted);font-weight:700;margin-bottom:12px;display:flex;align-items:center;gap:8px;}
.unit-title::after{content:'';flex:1;height:1px;background:var(--border);}
.lessons-row{display:flex;flex-direction:column;gap:8px;}
.lesson-btn{display:flex;align-items:center;gap:14px;background:var(--bg2);border:1px solid var(--border);border-radius:16px;padding:14px 16px;cursor:pointer;transition:all .2s;user-select:none;position:relative;overflow:hidden;}
.lesson-btn:active{transform:scale(.98);}
.lesson-btn.locked{opacity:.45;cursor:not-allowed;}
.lesson-btn.completed{border-color:#00ff8833;background:linear-gradient(90deg,#071a0e,var(--bg2));}
.lesson-btn.current{border-color:var(--green);box-shadow:0 0 20px #00ff8822;}
.lesson-icon{width:48px;height:48px;border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:24px;flex-shrink:0;}
.lesson-info{flex:1;}
.lesson-name{font-family:var(--display);font-size:14px;font-weight:800;}
.lesson-sub{font-size:10px;color:var(--muted);margin-top:3px;letter-spacing:.5px;}
.lesson-progress{height:3px;background:var(--border);border-radius:99px;margin-top:8px;overflow:hidden;}
.lesson-prog-fill{height:100%;background:var(--green);border-radius:99px;}
.lesson-badge{position:absolute;right:14px;top:50%;transform:translateY(-50%);font-size:18px;}
/* - LESSON SCREEN - */
.lesson-header{background:var(--bg2);padding:14px 16px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:12px;position:sticky;top:0;z-index:50;}
.back-btn{background:var(--bg3);border:1px solid var(--border);border-radius:10px;padding:8px 12px;color:var(--text);cursor:pointer;font-size:16px;flex-shrink:0;}
.lesson-prog-wrap{flex:1;background:var(--border);border-radius:99px;height:8px;overflow:hidden;}
.lesson-prog-bar{height:100%;background:linear-gradient(90deg,var(--green),var(--cyan));border-radius:99px;transition:width .4s;}
.hearts{display:flex;gap:3px;flex-shrink:0;}
.heart{font-size:18px;transition:all .3s;}
.heart.lost{filter:grayscale(1);opacity:.3;transform:scale(.8);}
.exercise-wrap{flex:1;padding:16px 16px 0;display:flex;flex-direction:column;gap:14px;}
/* Exercise types */
.ex-type-tag{font-size:9px;letter-spacing:3px;color:var(--muted);font-weight:700;}
.ex-question{font-family:var(--display);font-size:17px;font-weight:800;line-height:1.4;color:var(--text);}
.ex-concept{background:linear-gradient(135deg,#0a1a0e,#071019);border:1px solid #00ff8822;border-radius:12px;padding:14px;}
.ex-concept-title{font-size:10px;letter-spacing:2px;color:var(--green);margin-bottom:8px;font-weight:700;}
.code-block{background:#050510;border:1px solid var(--border);border-radius:10px;padding:12px 14px;font-size:13px;line-height:1.8;overflow-x:auto;white-space:pre;}
.code-block .kw{color:#c792ea;} .code-block .str{color:#c3e88d;} .code-block .fn{color:#82aaff;} .code-block .cm{color:#546e7a;} .code-block .num{color:#f78c6c;}
/* MCQ */
.mcq-options{display:flex;flex-direction:column;gap:8px;}
.mcq-opt{background:var(--bg2);border:2px solid var(--border);border-radius:14px;padding:14px 16px;cursor:pointer;transition:all .2s;font-size:13px;line-height:1.5;user-select:none;}
.mcq-opt:active{transform:scale(.98);}
.mcq-opt.selected{border-color:var(--cyan);background:#07101a;}
.mcq-opt.correct{border-color:var(--green);background:#071a0e;color:var(--green);}
.mcq-opt.wrong{border-color:var(--red);background:#1a0505;color:var(--red);}
/* Word bank (tap-to-build) */
.word-build-area{background:var(--bg2);border:2px solid var(--border);border-radius:14px;padding:14px;min-height:64px;display:flex;flex-wrap:wrap;gap:6px;align-items:flex-start;}
.word-bank{display:flex;flex-wrap:wrap;gap:6px;margin-top:4px;}
.word-chip{background:var(--bg3);border:2px solid var(--border);border-radius:10px;padding:7px 12px;font-size:13px;cursor:pointer;transition:all .15s;user-select:none;font-family:var(--mono);}
.word-chip:active{transform:scale(.95);}
.word-chip.used{opacity:.3;pointer-events:none;}
.word-chip.placed{background:#07101a;border-color:var(--cyan);color:var(--cyan);}
/* Code editor */
.code-editor{background:#050510;border:2px solid var(--border);border-radius:14px;padding:14px;font-family:var(--mono);font-size:13px;color:var(--text);width:100%;min-height:120px;resize:vertical;line-height:1.7;outline:none;transition:border-color .2s;}
.code-editor:focus{border-color:var(--green);}
.run-btn{background:var(--green);border:none;border-radius:12px;padding:12px 20px;color:#000;font-family:var(--mono);font-size:12px;font-weight:700;letter-spacing:2px;cursor:pointer;display:flex;align-items:center;gap:8px;}
.run-btn:active{opacity:.8;}
.output-box{background:#050510;border:1px solid var(--border);border-radius:10px;padding:12px 14px;font-size:12px;line-height:1.7;min-height:40px;color:#c3e88d;white-space:pre-wrap;}
.output-box.error{color:var(--red);}
/* Fill blank */
.fill-sentence{font-size:14px;line-height:2.2;display:flex;flex-wrap:wrap;align-items:center;gap:4px;}
.blank-input{background:transparent;border:none;border-bottom:2px solid var(--cyan);color:var(--cyan);font-family:var(--mono);font-size:14px;width:110px;text-align:center;outline:none;padding:2px 4px;}
/* Bottom action bar */
.action-bar{background:var(--bg2);border-top:1px solid var(--border);padding:14px 16px calc(14px + env(safe-area-inset-bottom));position:sticky;bottom:0;}
.check-btn{width:100%;padding:16px;border:none;border-radius:14px;font-family:var(--mono);font-size:13px;font-weight:700;letter-spacing:2px;cursor:pointer;transition:all .2s;}
.check-btn.ready{background:var(--green);color:#000;}
.check-btn.disabled{background:var(--bg3);color:var(--muted);cursor:not-allowed;}
.check-btn.continue{background:var(--cyan);color:#000;}
/* Feedback bar */
.feedback-bar{padding:16px;border-radius:14px;margin:0 0 4px;display:none;}
.feedback-bar.show{display:block;}
.feedback-bar.correct{background:#071a0e;border:1px solid var(--green);}
.feedback-bar.wrong{background:#1a0505;border:1px solid var(--red);}
.fb-title{font-family:var(--display);font-size:15px;font-weight:900;margin-bottom:4px;}
.fb-correct .fb-title{color:var(--green);}
.fb-wrong .fb-title{color:var(--red);}
.fb-explain{font-size:12px;color:#94a3b8;line-height:1.6;}
/* - COMPLETE SCREEN - */
.complete-screen{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:32px 20px;text-align:center;}
.complete-emoji{font-size:80px;margin-bottom:16px;animation:pop .5s ease;}
@keyframes pop{0%{transform:scale(0)}80%{transform:scale(1.15)}100%{transform:scale(1)}}
.complete-title{font-family:var(--display);font-size:28px;font-weight:900;color:var(--green);margin-bottom:8px;}
.complete-sub{font-size:13px;color:var(--muted);margin-bottom:28px;line-height:1.6;}
.xp-earned{font-family:var(--display);font-size:48px;font-weight:900;color:var(--yellow);margin-bottom:4px;}
.xp-earned-lbl{font-size:11px;color:var(--muted);letter-spacing:2px;margin-bottom:24px;}
.stat-boxes{display:flex;gap:12px;margin-bottom:32px;width:100%;}
.stat-box{flex:1;background:var(--bg2);border:1px solid var(--border);border-radius:14px;padding:14px;text-align:center;}
.stat-box-val{font-family:var(--display);font-size:22px;font-weight:900;color:var(--cyan);}
.stat-box-lbl{font-size:9px;color:var(--muted);letter-spacing:1.5px;margin-top:4px;}
.continue-home-btn{width:100%;padding:16px;background:var(--green);border:none;border-radius:14px;color:#000;font-family:var(--mono);font-size:13px;font-weight:700;letter-spacing:2px;cursor:pointer;}
/* - TOAST - */
.toast{position:fixed;top:70px;left:50%;transform:translateX(-50%) translateY(-10px);background:var(--green);color:#000;padding:9px 22px;border-radius:99px;font-size:12px;font-weight:700;letter-spacing:2px;opacity:0;transition:all .3s;z-index:999;pointer-events:none;white-space:nowrap;}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0);}
/* - SNEK WIDGET - */
.snek-float{position:fixed;bottom:82px;right:14px;z-index:90;font-size:44px;cursor:pointer;animation:snekBob 2.5s ease-in-out infinite;filter:drop-shadow(0 4px 10px #00ff8866);}
@keyframes snekBob{0%,100%{transform:translateY(0)}50%{transform:translateY(-7px)}}
/* - STREAKFREEZE modal - */
.overlay{position:fixed;inset:0;background:#000000bb;z-index:200;display:none;align-items:flex-end;justify-content:center;}
.overlay.show{display:flex;}
.modal{background:var(--bg2);border:1px solid var(--border);border-radius:24px 24px 0 0;padding:28px 20px 40px;width:100%;max-width:480px;animation:slideUp .3s ease;}
@keyframes slideUp{from{transform:translateY(100%)}to{transform:translateY(0)}}
.modal-title{font-family:var(--display);font-size:22px;font-weight:900;text-align:center;margin-bottom:6px;}
.modal-sub{font-size:12px;color:var(--muted);text-align:center;margin-bottom:20px;line-height:1.6;}
.modal-close{width:100%;padding:14px;background:var(--green);border:none;border-radius:12px;color:#000;font-family:var(--mono);font-size:13px;font-weight:700;letter-spacing:2px;cursor:pointer;margin-top:8px;}
/* Nav bar */
.nav-bar{position:fixed;bottom:0;left:50%;transform:translateX(-50%);width:100%;max-width:480px;background:var(--bg2);border-top:1px solid var(--border);display:flex;padding:6px 0 calc(6px + env(safe-area-inset-bottom));z-index:80;}
.nav-btn{flex:1;background:none;border:none;color:var(--muted);cursor:pointer;padding:6px 0;font-size:9px;letter-spacing:1.5px;display:flex;flex-direction:column;align-items:center;gap:3px;font-family:var(--mono);}
.nav-btn.active{color:var(--green);}
.nav-icon{font-size:22px;}
/* - PROFILE SCREEN - */
.profile-wrap{flex:1;overflow-y:auto;padding:20px 16px 100px;}
.profile-hero{text-align:center;padding:20px 0 28px;}
.profile-avatar{font-size:80px;margin-bottom:10px;}
.profile-name{font-family:var(--display);font-size:22px;font-weight:900;color:var(--green);}
.profile-tagline{font-size:11px;color:var(--muted);margin-top:4px;letter-spacing:1px;}
.section-head{font-size:9px;letter-spacing:3px;color:var(--muted);font-weight:700;margin:20px 0 10px;}
.card{background:var(--bg2);border:1px solid var(--border);border-radius:14px;padding:14px;margin-bottom:10px;}
.ach-item{display:flex;align-items:center;gap:12px;padding:8px 0;border-bottom:1px solid var(--border);}
.ach-item:last-child{border-bottom:none;}
.ach-icon{font-size:28px;width:44px;text-align:center;}
.ach-name{font-size:13px;font-weight:700;color:var(--text);}
.ach-sub{font-size:11px;color:var(--muted);margin-top:2px;}
.ach-item.locked .ach-icon{filter:grayscale(1);opacity:0.4;}
.ach-item.locked .ach-name,.ach-item.locked .ach-sub{color:var(--muted);}
</style>
</head>
<body>

<!-- TOAST -->
<div class="toast" id="toast"></div>

<!-- SNEK FLOAT -->
<div class="snek-float" id="snekFloat" onclick="snekSay()" title="Tap Snek!">üêç</div>

<!-- NO HEARTS MODAL -->
<div class="overlay" id="noHeartsOverlay">
  <div class="modal">
    <div style="font-size:52px;text-align:center;margin-bottom:12px">&#128148;</div>
    <div class="modal-title" style="color:var(--red)">OUT OF HEARTS!</div>
    <div class="modal-sub">You made too many mistakes. Take a break, review the lesson, and try again. You've got this!</div>
    <button class="modal-close" onclick="closeOverlay('noHeartsOverlay');goScreen('home');buildHomeUI();">BACK TO HOME</button>
  </div>
</div>

<!-- EXIT LESSON MODAL -->
<div class="overlay" id="exitOverlay">
  <div class="modal">
    <div style="font-size:52px;text-align:center;margin-bottom:12px">üö™</div>
    <div class="modal-title" style="color:var(--orange)">QUIT LESSON?</div>
    <div class="modal-sub">Your progress in this lesson will be lost. You won't lose your overall XP or streak.</div>
    <button class="modal-close" style="background:var(--red);margin-bottom:10px" onclick="confirmExit()">YES, QUIT</button>
    <button class="modal-close" style="background:var(--bg3);color:var(--text);border:1px solid var(--border)" onclick="closeOverlay('exitOverlay')">KEEP GOING üí™</button>
  </div>
</div>

<!-- SNEK MODAL -->
<div class="overlay" id="snekOverlay">
  <div class="modal">
    <div style="font-size:64px;text-align:center;margin-bottom:12px" id="snekModalEmoji">üêç</div>
    <div class="modal-title" id="snekModalTitle">SNEK SAYS</div>
    <div class="modal-sub" id="snekModalMsg">...</div>
    <button class="modal-close" onclick="closeOverlay('snekOverlay')">GOT IT üí™</button>
  </div>
</div>

<!-- = HOME SCREEN = -->
<div class="screen active" id="screen-home">
  <div class="home-header">
    <div class="home-logo">PyQuest üêç</div>
    <div class="home-tagline">LEARN PYTHON ¬∑ GO TO GERMANY</div>
    <div class="stat-strip">
      <div class="stat-chip"><div class="stat-big" id="h-xp">0</div><div class="stat-lbl">XP</div></div>
      <div class="stat-chip"><div class="stat-big" id="h-streak" style="color:var(--red)">0üî•</div><div class="stat-lbl">STREAK</div></div>
      <div class="stat-chip"><div class="stat-big" id="h-level">LV1</div><div class="stat-lbl">LEVEL</div></div>
      <div class="stat-chip"><div class="stat-big" id="h-hearts" style="color:var(--red)">‚ù§Ô∏è5</div><div class="stat-lbl">HEARTS</div></div>
    </div>
    <div class="xp-bar-wrap"><div class="xp-bar-fill" id="h-xpbar" style="width:0%"></div></div>
    <div class="xp-meta"><span id="h-xpmeta">0 / 100 XP</span><span id="h-xppct">0%</span></div>
  </div>
  <div class="units-scroll" id="unitsScroll"></div>
  <div class="nav-bar">
    <button class="nav-btn active" onclick="goScreen('home',this)"><span class="nav-icon">üè†</span><span>LEARN</span></button>
    <button class="nav-btn" onclick="goScreen('profile',this)"><span class="nav-icon">üèÜ</span><span>PROFILE</span></button>
  </div>
</div>

<!-- = LESSON SCREEN = -->
<div class="screen" id="screen-lesson">
  <div class="lesson-header">
    <button class="back-btn" onclick="exitLesson()">‚úï</button>
    <div class="lesson-prog-wrap"><div class="lesson-prog-bar" id="lessonProgBar" style="width:0%"></div></div>
    <div class="hearts" id="heartsDisplay"></div>
  </div>
  <div class="exercise-wrap" id="exerciseWrap"></div>
  <div style="padding:0 16px" id="feedbackArea"></div>
  <div class="action-bar">
    <button class="check-btn disabled" id="checkBtn" onclick="handleCheck()">CHECK</button>
  </div>
</div>

<!-- = COMPLETE SCREEN = -->
<div class="screen" id="screen-complete">
  <div class="complete-screen">
    <div class="complete-emoji" id="completeEmoji">üéâ</div>
    <div class="complete-title" id="completeTitle">LESSON COMPLETE!</div>
    <div class="complete-sub" id="completeSub">You're one step closer to Germany.</div>
    <div class="xp-earned" id="xpEarned">+0</div>
    <div class="xp-earned-lbl">XP EARNED</div>
    <div class="stat-boxes">
      <div class="stat-box"><div class="stat-box-val" id="c-acc">0%</div><div class="stat-box-lbl">ACCURACY</div></div>
      <div class="stat-box"><div class="stat-box-val" id="c-time">0s</div><div class="stat-box-lbl">TIME</div></div>
      <div class="stat-box"><div class="stat-box-val" id="c-streak">0</div><div class="stat-box-lbl">STREAK</div></div>
    </div>
    <button class="continue-home-btn" onclick="finishLesson()">CONTINUE üêç</button>
  </div>
</div>

<!-- = PROFILE SCREEN = -->
<div class="screen" id="screen-profile">
  <div class="profile-wrap">
    <div class="profile-hero">
      <div class="profile-avatar">üêç</div>
      <div class="profile-name">PYTHON WARRIOR</div>
      <div class="profile-tagline" id="p-tagline">DESTINATION: GERMANY üá©üá™</div>
    </div>
    <div class="section-head">üìä YOUR STATS</div>
    <div class="card" id="statsCard"></div>
    <div class="section-head">üèÜ ACHIEVEMENTS</div>
    <div class="card" id="achCard"></div>
  </div>
  <div class="nav-bar">
    <button class="nav-btn" onclick="goScreen('home',this)"><span class="nav-icon">üè†</span><span>LEARN</span></button>
    <button class="nav-btn active" onclick="goScreen('profile',this)"><span class="nav-icon">üèÜ</span><span>PROFILE</span></button>
  </div>
</div>

<script>
// =
// CURRICULUM - Full Python course, Duolingo-style
// =
const CURRICULUM = [
  {
    id:'u1', title:'UNIT 1 - THE BASICS', color:'#00ff88', icon:'\uD83D\uDC0D',
    lessons:[
      {
        id:'u1l1', name:'Your First Python', sub:'print() and saying hello',
        icon:'\uD83D\uDC4B', color:'#00ff88',
        exercises:[
          { type:'learn', title:'What is Python?',
            content:`Python is a programming language used to build websites, apps, AI, and automate boring stuff. In Python, to show something on screen you use <span class="fn">print()</span>.`,
            code:`<span class="fn">print</span>(<span class="str">"Hello, World!"</span>)\n<span class="cm"># Output: Hello, World!</span>`
          },
          { type:'mcq', question:'What function do you use to display text in Python?',
            options:['show()','display()','print()','write()'], correct:2,
            explain:'print() is the built-in function to display output in Python.'
          },
          { type:'code', question:'Write code to print your name. Use print() with your name in quotes.',
            starter:'# Write your code here\n', check:'output', expected:'any', hint:'print("YourName")'
          },
          { type:'wordbuild', question:'Build the code to print "Python rocks!"',
            words:['print(','show','python','rocks',')', '"Python rocks!"', 'display'], answer:'print("Python rocks!")',
            pieces:['print(', '"Python rocks!"', ')']
          },
          { type:'fillin', qu
